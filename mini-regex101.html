<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mini RegExp101</title>
    <style>
      .regexp101-main #regexpInput {
        width: 500px;
      }
      .regexp101-main #stringInput,
      .regexp101-main #result {
        width: 500px;
        height: 200px;
      }
      #regexpInput,
      #stringInput,
      #result {
        box-sizing: border-box;
        padding: 0.5em;
        border: 2px solid;
        border-radius: 0.5em;
        margin: 0.3em;
        font-size: 1.5em;
        font-family: consolas;
        outline: none;
      }
      label[for="regexpInput"],
      label[for="stringInput"] {
        font-size: 1.5em;
        margin: 0.3em;
      }
      .regexpOptions {
        box-sizing: border-box;
        font-size: 1.5em;
        margin: 0.3em;
      }
      .regexpOptions input {
        margin-left: 0;
      }
      #result span {
        background-color: #d5ebff;
        font-weight: bold;
      }
      #result span:nth-child(even) {
        background-color: #9fcfff;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <button type="button" onclick="run()">显示结果</button>
    <div class="regexp101-main">
      <div class="regexpOptions">
        <input type="checkbox" name="global" id="g" />
        <label for="g">g</label>
        <input type="checkbox" name="multi-line" id="m" />
        <label for="m">m</label>
        <input type="checkbox" name="insensitive" id="i" />
        <label for="i">i</label>
        <input type="checkbox" name="sticky" id="y" />
        <label for="y">y</label>
        <input type="checkbox" name="unicode" id="u" />
        <label for="u">u</label>
        <input type="checkbox" name="single-line" id="s" />
        <label for="s">s</label>
        <input type="checkbox" name="indices" id="d" />
        <label for="d">d</label>
      </div>
      <label for="regexpInput">Regular Expressions</label>
      <br />
      <input type="text" id="regexpInput" onkeypress="run()" />
      <br />
      <label for="stringInput">Test String</label>
      <br />
      <textarea name="" id="stringInput" cols="30" rows="10"></textarea>
      <pre id="result"></pre>
    </div>
    <script>
      function run() {
        const reStr = regexpInput.value;
        const text = stringInput.value;
        const re = new RegExp(reStr, "g");
        let html = "";
        let match = null;
        let lastIndex = 0;

        while ((match = re.exec(text))) {
          html += text.slice(lastIndex, match.index);
          html += "<span>" + match[0] + "</span>";
          lastIndex = re.lastIndex;
          if (match[0].length === 0) {
            re.lastIndex++;
          }
        }

        html += text.slice(lastIndex);

        result.innerHTML = html;
      }
    </script>
  </body>
</html>
